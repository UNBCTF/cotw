<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>UNB Cybersec</title>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.6.3/css/all.css" integrity="sha384-UHRtZLI+pbxtHCWp1t77Bi1L4ZtiqrqD80Kn4Z8NTSRyMA2Fd33n5dQ8lWUE00s/" crossorigin="anonymous">
    <link rel="stylesheet" href="./assets/css/bootstrap4-neon-glow.min.css">
    <link href="https://fonts.googleapis.com/css?family=Roboto" rel="stylesheet">
    <link rel='stylesheet' href='https://cdn.jsdelivr.net/font-hack/2.020/css/hack.min.css'>
</head>

<body>
    <div class="container">
        <div class="jumbotron bg-transparent mb-0 radius-0">
            <h1 class="display-2">UNB Cybersec Dem<span class="vim-caret">o</span></h1>
            <div class="lead mb-3 text-mono text-danger">The University of New Brunswick's own Cybersecurity Club!</div>
            <div class="text-darkgrey text-mono my-2">*Weekly meetings are held in-person on Wednesdays in Head Hall from 6:30pm-8:00pm</div>
            <div class="text-mono">
                <a href="https://discord.gg/kU6MRNr82J"
                    class="btn btn-danger btn-shadow px-3 my-2 ml-0 text-left">
                    Join our Discord!
                </a>
                <a href="https://unbcybersec.com/"
                    class="btn btn-danger btn-shadow px-3 my-2 ml-0 ml-sm-1 text-left">
                    More info at unbcybersec.com!
                </a>
            </div>
        </div>

        <!-- Web Section -->
        <section class="mt-5">
            <h3 class="display-3">Web</h3>
            <div class="row">
                <!-- Card 1 -->
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Command Injection</h5>
                            <p class="card-text">
                                Can you find a way to run commands on this web server?
                                <hr>
                                <a target="_blank" href="http://demo.unbcybersec.com:50023">dictionary</a>
                            </p>
                            <div class="input-group">
                                <input id="inputCommandInjection" type="text" class="form-control" placeholder="Enter the flag: demo{...}">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" onclick="checkAnswer('inputCommandInjection', 'outputCommandInjection', '6c42ec9b775ca9d32d56e2e6632e5922ccdee08b33c29d53bff0c9f3e1098672')">Check</button>
                                </div>
                            </div>
                            <div id="outputCommandInjection"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Local File Inclusion</h5>
                            <p class="card-text">
                                A website is just a bunch of files. See if you can find the <code>flag.txt</code> file!
                                <hr>
                                <a target="_blank" href="http://demo.unbcybersec.com:50011">cats</a>
                            </p>
                            <div class="input-group">
                                <input id="inputLFI" type="text" class="form-control" placeholder="Enter the flag: demo{...}">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" onclick="checkAnswer('inputLFI', 'outputLFI', 'd2e72e6b6d829adcc38a09118686e0cb029b285208682fda0546a973ece34a90')">Check</button>
                                </div>
                            </div>
                            <div id="outputLFI"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">SQL Injection</h5>
                            <p class="card-text">
                                Many apps use SQL for their databases... and some apps let us inject our own.
                                <hr>
                                <a target="_blank" href="http://demo.unbcybersec.com:50040">adminsonly</a>
                            </p>
                            <div class="input-group">
                                <input id="inputSQLI" type="text" class="form-control" placeholder="Enter the flag: demo{...}">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" onclick="checkAnswer('inputSQLI', 'outputSQLI', 'f4805145ebdb57a1359f8c58b31b0d532324c5ff09d70d71739ade1db71e92d0')">Check</button>
                                </div>
                            </div>
                            <div id="outputSQLI"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Remote Code Execution</h5>
                            <p class="card-text">
                                Coding is fun, but surely no one can run their own on my server...
                                <hr>
                                <a target="_blank" href="http://demo.unbcybersec.com:50036">calculator</a>
                            </p>
                            <div class="input-group">
                                <input id="inputRCE" type="text" class="form-control" placeholder="Enter the flag: demo{...}">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" onclick="checkAnswer('inputRCE', 'outputRCE', '95538a6faa1bc76237818e53043ee65c638cf1d8f288da2114882ae6f0d61049')">Check</button>
                                </div>
                            </div>
                            <div id="outputRCE"></div>
                        </div>
                    </div>
                </div>

                <!-- Add more cards as needed -->
            </div>
        </section>

        <!-- Reversing Section -->
        <section class="mt-5">
            <h3 class="display-3">Reversing</h3>
            <div class="row">
                <!-- Card 1 -->
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Java Moose 1</h5>
                            <p class="card-text">
                                Sometimes the flag is right there...
                                <hr>
                                <a target="_blank" href="http://demo.unbcybersec.com/files/java-moose-1.class">java-moose-1.class</a>
                            </p>
                            <div class="input-group">
                                <input id="inputJavaMoose1" type="text" class="form-control" placeholder="Enter the flag: demo{...}">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" onclick="checkAnswer('inputJavaMoose1', 'outputJavaMoose1', 'hash')">Check</button>
                                </div>
                            </div>
                            <div id="outputJavaMoose1"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Java Moose 2</h5>
                            <p class="card-text">
                                Sometimes the password is right there...
                                <hr>
                                <a target="_blank" href="http://demo.unbcybersec.com/files/java-moose-2.class">java-moose-2.class</a>
                            </p>
                            <div class="input-group">
                                <input id="inputJavaMoose2" type="text" class="form-control" placeholder="Enter the flag: demo{...}">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" onclick="checkAnswer('inputJavaMoose2', 'outputJavaMoose2', 'hash')">Check</button>
                                </div>
                            </div>
                            <div id="outputJavaMoose2"></div>
                        </div>
                    </div>
                </div>

                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Java Moose 3</h5>
                            <p class="card-text">
                                And sometimes they're both nearby...
                                <hr>
                                <a target="_blank" href="http://demo.unbcybersec.com/files/java-moose-3.class">java-moose-3.class</a>
                            </p>
                            <div class="input-group">
                                <input id="inputJavaMoose3" type="text" class="form-control" placeholder="Enter the flag: demo{...}">
                                <div class="input-group-append">
                                    <button class="btn btn-danger" onclick="checkAnswer('inputJavaMoose3', 'outputJavaMoose3', 'hash')">Check</button>
                                </div>
                            </div>
                            <div id="outputJavaMoose3"></div>
                        </div>
                    </div>
                </div>

                <!-- Add more cards as needed -->
            </div>
        </section>

        <!-- Crypto Section -->
        <section class="mt-5">
            <h3 class="display-3">Crypto</h3>
            <div class="row">
                <!-- Card 1 -->
                <div class="col-md-4 mb-4">
                    <div class="card">
                        <div class="card-body">
                            <h5 class="card-title">Crypto Card 1</h5>
                            <p class="card-text">Description for Crypto Card 1.</p>
                            <div class="input-group">
                                <input type="text" class="form-control" placeholder="Enter the flag">
                                <div class="input-group-append">
                                    <button class="btn btn-danger">Check</button>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Add more cards as needed -->
            </div>
        </section>
    </div>

    <!-- Footer -->
    <footer class="bg-dark text-white text-center py-3 mt-5">
        UNB Cybersecurity Club &copy; 2024
    </footer>

    <!-- Bootstrap 4.3.1 JS and Popper.js (required for Bootstrap) -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js" integrity="sha384-q8i/X+965DzO0rT7abK41JStQIAqVgRVzpbzo5smXKp4YfRvH+8abtTE1Pi6jizo" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/popper.js@1.14.7/dist/umd/popper.min.js" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/js/bootstrap.min.js" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" crossorigin="anonymous"></script>

    <script>
        function checkAnswer(inputId, outputId, expectedHash) {
            var userInput = document.getElementById(inputId).value;

            // Convert user input to Uint8Array
            var encoder = new TextEncoder();
            var data = encoder.encode(userInput);

            // Check if input is in correct format regex '^demo{[.*]}$'
            if (userInput.match(/^demo{.*}$/) === null) {
                showOutput(outputId, 'Remember: all flags are like demo{...}', 'warning');
                return;
            }

            // Compute SHA-256 hash
            crypto.subtle.digest('SHA-256', data).then(function (hashBuffer) {
                var hashArray = Array.from(new Uint8Array(hashBuffer));
                var hashHex = hashArray.map(byte => byte.toString(16).padStart(2, '0')).join('');

                // Compare the computed hash with the expected hash
                if (hashHex === expectedHash) {
                    showOutput(outputId, 'Success! You got the flag!', 'success');
                } else {
                    showOutput(outputId, 'Incorrect. Maybe next time.', 'danger');
                }
            }).catch(function (error) {
                console.error('Error computing hash:', error);
            });
        }

        function showOutput(outputId, message, type) {
            var outputDiv = document.getElementById(outputId);
            outputDiv.className = 'alert alert-' + type + ' mt-2 mb-0';
            outputDiv.role = 'alert';
            outputDiv.textContent = message;
        }
    </script>
</body>

</html>